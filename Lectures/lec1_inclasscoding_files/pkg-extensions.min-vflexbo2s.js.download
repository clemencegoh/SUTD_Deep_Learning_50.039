define("modules/clean/react/app_actions/app_actions_store",["require","exports","tslib","modules/clean/filepath","modules/clean/api_v2/user_client"],function(e,t,n,a,i){"use strict";function o(e){return void 0!==e.ext}function r(e){return void 0!==e.fq_path}function s(e){return void 0!==e.filename}function c(e){return o(e)?e.ext:r(e)?"."+a.file_extension(a.filename(e.fq_path)):s(e)?"."+a.file_extension(e.filename):void 0}function u(){return l("",[],!1)}function l(e,t,n){return{fileId:e,actionCategories:t,showMenu:n}}function d(){return m||(m=new p(new i.UserApiV2Client)),m}Object.defineProperty(t,"__esModule",{value:!0}),t.emptyExtensionsConfig=u,t.newExtensionsConfig=l;var p=(function(){function e(e){this.actionIdToAppAction={},this.client=e}return e.prototype.getActionsForFile=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var a;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this.getActionsForFileBatch([e],t)];case 1:return a=n.sent(),[2,a[e.file_id]||u()]}})})},e.prototype.getActionsForFileBatch=function(e,t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this.loadActionsByUser(e,t)]})})},e.prototype.loadActionsByUser=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var a,i,o,r;return n.__generator(this,function(n){switch(n.label){case 0:this.stateRequest||(this.stateRequest=this.loadActions(t)),a=this.stateRequest,i={},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.stateRequest];case 2:return o=n.sent(),e.forEach(function(e){var t=void 0,n=c(e);n&&(t=o.extToCategories[n]),i[e.file_id]=l(e.file_id,t||[],o.appActionsEnabled&&!e.is_dir)}),[3,4];case 3:return r=n.sent(),a===this.stateRequest&&(this.stateRequest=void 0),[3,4];case 4:return[2,i]}})})},e.prototype.loadActions=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,a,i,o=this;return n.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.client.ns("app_actions").rpc("get_actions_for_user",{},{subjectUserId:e})];case 1:return t=n.sent(),t.actions.forEach(function(e){o.actionIdToAppAction[e.id]||(o.actionIdToAppAction[e.id]=e)}),a={},t.action_mapping.forEach(function(e){var t=e.matcher;if("extension"===t[".tag"]){var n=t.extension,i={},r=[];e.action_ids.forEach(function(e){var t=o.actionIdToAppAction[e],n=i[t.category];n?n.actions.push(t):(n={categoryId:t.category,actions:[t]},i[t.category]=n,r.push(n))}),r=r.map(function(e){return{categoryId:e.categoryId,actions:o.prioritizeActions(e.actions)}}),a[n]=r}}),[2,{appActionsEnabled:!0,extToCategories:a}];case 2:if(i=n.sent(),i.error&&"feature_gated"===i.error[".tag"])return[2,{appActionsEnabled:!1,extToCategories:{}}];throw i;case 3:return[2]}})})},e.prototype.prioritizeActions=function(e){return e.sort(function(e,t){return e.priority&&t.priority?t.priority-e.priority:e.priority?-1:t.priority?1:e.description<t.description?-1:e.description>t.description?1:0})},e})();t.AppActionsStore=p;var m;t.getAppActionsStore=d}),define("modules/clean/react/app_actions/category",["require","exports","modules/core/i18n"],function(e,t,n){"use strict";function a(e){return t.CATEGORY_FILETYPE_MAP[e][1]}function i(e){return r[e]||null}Object.defineProperty(t,"__esModule",{value:!0});var o={0:{displayName:n._("DEFAULT")},1:{displayName:n._("Send for signature"),developerDescription:n._("Send for signature")},2:{displayName:n._("Edit"),developerDescription:n._("PDF editing")},3:{displayName:n._("View or Edit"),developerDescription:n._("View or edit")},4:{displayName:n._("Edit"),developerDescription:n._("Image editing")},5:{displayName:n._("Video comment"),developerDescription:n._("Video comment")},6:{displayName:n._("Send fax"),developerDescription:n._("Send fax")}};(function(e){function t(e){return o[e]||null}function n(e){var n=t(e);return n&&n.displayName}function a(e){var n=t(e);return n&&n.developerDescription||null}e.DEFAULT=0,e.ESIGNATURE=1,e.PDF_EDITING=2,e.VIEW_OR_EDIT=3,e.IMAGE_EDITING=4,e.VIDEO_COMMENT=5,e.SEND_FAX=6,e.getDisplayName=n,e.getDeveloperDescription=a})(t.Category||(t.Category={}));var r={0:n._("Default"),1:n._("Edit"),2:n._("Edit"),3:n._("Video comment"),4:n._("View or Edit"),5:n._("Send for signature"),6:n._("Send fax")};t.CATEGORY_FILETYPE_MAP=[[0,n._("Select app category..."),[]],[1,n._("Send for signature"),[".pdf",".doc",".docx"]],[2,n._("PDF editing"),[".pdf"]],[3,n._("Preview"),[".dwg"]],[4,n._("Image editing"),[".png",".jpg",".jpeg",".tiff"]],[5,n._("Video comment"),[".mp4",".mov",".m4v",".wmv",".mpg"]],[6,n._("Send fax"),[".pdf",".doc",".docx"]]],t.getCategoryNameById=a,t.getDisplayString=i}),define("modules/clean/react/app_actions/data/action_creators",["require","exports","tslib","modules/clean/react/app_actions/app_actions_store","modules/clean/react/app_actions/data/types"],function(e,t,n,a,i){"use strict";var o=this;Object.defineProperty(t,"__esModule",{value:!0}),t.updateExtensionConfigWithNewFiles=function(e){var t=e.files,r=e.user;return function(e,s){return n.__awaiter(o,void 0,void 0,function(){var o;return n.__generator(this,function(n){switch(n.label){case 0:return[4,a.getAppActionsStore().getActionsForFileBatch(t,r.id)];case 1:return o=n.sent(),e({type:i.ActionTypes.UPDATE_EXTENSIONS_CONFIG_WITH_NEW_FILES,payload:{fileIdToExtensionsConfigs:o}}),[2]}})})}}}),define("modules/clean/react/app_actions/data/types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.UPDATE_EXTENSIONS_CONFIG_WITH_NEW_FILES="EXTENSIONS/UPDATE_EXTENSIONS_CONFIG_WITH_NEW_FILES"})(t.ActionTypes||(t.ActionTypes={}))}),define("modules/clean/react/app_actions/feedback_modal",["require","exports","tslib","modules/clean/ajax","react","modules/clean/react/css","modules/clean/react/image","spectrum/button","modules/core/i18n","modules/clean/react/modal","spectrum/input","modules/clean/static_urls","modules/clean/filepath","modules/clean/file_store/utils","spectrum/dropdown_menu","dropins_sdk_refactor/dropins_sdk_internal","modules/constants/dropins"],function(e,t,n,a,i,o,r,s,c,u,l,d,p,m,f,_,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importStar(a),i=n.__importDefault(i),t.bugReport=c._("Report a problem"),t.suggestSomething=c._("Suggest something");var g="extensions-feedback",b=[t.bugReport,t.suggestSomething],y=(function(e){function o(n){var o=e.call(this,n)||this;return o.submitFeedback=function(){var e=o.state.detailsText;if(o.state.screenshotLinks){e+=" (Screenshot links: "+o.state.screenshotLinks.join("; ")+")"}if(o.state.category===t.bugReport){var n="[Extensions]"+o.state.subjectText;a.SilentBackgroundRequest({url:"/support_ajax/support_form",data:{user_email:o.props.user.email,subject_posted:n,details_posted:e}})}else a.SilentBackgroundRequest({url:"/aa/app_choice_feedback",subject_user:o.props.user.id,data:{ext:o.getFileExt(),other_suggested_apps:o.state.subjectText,comments:e,surface:o.props.surface||"unknown",menu_contents:o.props.visibleMenuItems?o.props.visibleMenuItems.join(", "):""}});o.setState({showThankYouModal:!0})},o.handleSubjectChanged=function(e){o.setState({subjectText:e.currentTarget.value.trim()})},o.handleDetailsChanged=function(e){o.setState({detailsText:e.currentTarget.value.trim()})},o.handleChooseFromDropbox=function(){_.Dropbox.choose({linkType:"preview",multiselect:!0,success:function(e){var t=e.map(function(e){return e.link}),n=e.map(function(e){return e.name});o.setState({screenshotLinks:t,attachmentNames:n})},extensions:["images","video"]})},o.isAnyFeedbackInput=function(){return o.state.subjectText.length>0||o.state.detailsText.length>0},o.handleCategoryChange=function(e){o.setState({category:e})},o.renderFeedbackModel=function(){return i.default.createElement(u.Modal,{className:g+"-modal",ariaLabel:"Feedback Modal",acceptButtonText:null,style:"clean",autoFocusPrimaryInput:!1,width:"560"},i.default.createElement("div",{className:g+"-inputs"},i.default.createElement("div",{className:g+"-title"},i.default.createElement("h1",{className:g+"-modal-header"},c._("Send feedback"))),i.default.createElement("div",{className:g+"-container"},i.default.createElement(f.DropdownMenu,{id:"select--category",className:g+"-category-selector",onSelection:o.handleCategoryChange},i.default.createElement(f.DropdownMenuButton,{fullWidth:!0,className:"menu-button"},o.state.category),i.default.createElement(f.Menu,null,o.renderCategoryItems())),i.default.createElement("label",{htmlFor:g+"-subject-input",className:g+"-label"},c._("Subject")),i.default.createElement(l.Input,{id:"subject-input",className:g+"-subject-input",onChange:o.handleSubjectChanged,"aria-label":c._("subject input")}),i.default.createElement("label",{htmlFor:g+"-details-input",className:g+"-label"},c._("Details")),i.default.createElement("textarea",{id:"details-input",className:g+"-details-input",onChange:o.handleDetailsChanged,"aria-label":c._("details input"),rows:4}),i.default.createElement(s.Button,{variant:"secondary",className:g+"-screenshot-button",onClick:o.handleChooseFromDropbox},c._("Add a screenshot")),o.renderSelectedScreenshot())),i.default.createElement("div",{className:g+"-action-bar"},i.default.createElement(s.Button,{variant:"secondary",className:"action-bar-cancel-button",onClick:o.props.onBack},c._("Cancel")),i.default.createElement("div",{className:g+"-action-bar-space"}),i.default.createElement(s.Button,{variant:"primary",className:"action-bar-submit-button",disabled:!o.isAnyFeedbackInput(),onClick:o.submitFeedback},c._("Submit"))))},o.renderThankYouModal=function(){return i.default.createElement(u.Modal,{className:g+"-thank-you-modal",ariaLabel:"Feedback Modal",acceptButtonText:null,style:"clean"},i.default.createElement(r.Image,{className:g+"-thank-you-image",alt:c._("Thank you"),src:d.static_url("/static/images/app_actions/feedback_comments-vfluWMAvS.png"),srcHiRes:d.static_url("/static/images/app_actions/feedback_comments@2x-vflWa-9nT.png")}),i.default.createElement("h1",{className:g+"-thank-you-header"},c._("Thanks for letting us know!")),i.default.createElement("h2",{className:g+"-thank-you-subtext"},c._("Your feedback will help make Dropbox even better.")))},o.state={category:t.bugReport,subjectText:"",detailsText:"",screenshotLinks:[],attachmentNames:[],showThankYouModal:!1},_.Dropbox.init({appKey:h.CHOOSER_APP_KEY}),o}return n.__extends(o,e),o.prototype.getFileExt=function(){var e=this.props.file;return void 0===e?null:m.isSharedFile(e)&&e.filename?p.file_extension(e.filename):m.isBrowseFile(e)&&e.ext?e.ext:""},o.prototype.renderCategoryItems=function(){var e=this;return b.map(function(t){return i.default.createElement(f.MenuItem,{value:t,key:t,selected:e.state.category===t},t)})},o.prototype.renderSelectedScreenshot=function(){return this.state.attachmentNames.map(function(e){return i.default.createElement("p",null,e)})},o.prototype.render=function(){return this.state.showThankYouModal?this.renderThankYouModal():this.renderFeedbackModel()},o})(i.default.Component);t.FeedbackModal=o.requireCssWithComponent(y,["/static/css/app_actions/index-vfl6C6JFW.css"])});
//# sourceMappingURL=pkg-extensions.min.js-vfl3BOjXZ.map