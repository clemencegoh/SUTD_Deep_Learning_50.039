define(["require","exports","tslib","react","external/react-dom","external/lodash","modules/clean/react/previews/pdf_viewer/progress_bar","modules/clean/react/previews/pdf_viewer/urls","modules/clean/react/previews/pdf_viewer/utils","modules/core/exception","modules/core/i18n"],function(e,t,a,n,o,r,d,i,s,m,p){"use strict";function u(e,t,a){void 0===a&&(a=!1);var d=window.open("about:blank");if(!d)throw new Error(p._("Could not open new window"));var i=r.maxBy(e.dimensions,function(e){return e[2]}),s=i[0]/72,m=i[1]/72;window.setTimeout(function(){var r=d.document.createElement("style");r.innerHTML="\n      @page { margin: 0; size: "+s+"in "+m+"in; }\n      img { width: 100%; }\n      .print-progress { height: 8px; background-color: #0070E0; float: left; }\n    ",d.document.head.appendChild(r);var i=d.document.createElement("div");d.document.body.appendChild(i);var p=function(){d.print()};o.render(n.default.createElement(l,{metadata:e,document:d.document,onLoad:p,imageUrlTmpl:t,useCanned:a}),i)},50)}Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n),o=a.__importStar(o),r=a.__importStar(r);var l=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.imagesLoaded={},t.state={numImagesLoaded:0},t.onImageResolve=function(e){return function(){t.state.numImagesLoaded<t.props.metadata.page_count&&!t.imagesLoaded[e]&&(t.imagesLoaded[e]=!0,t.setState(function(e,t){return{numImagesLoaded:e.numImagesLoaded+1}}))}},t}return a.__extends(t,e),t.prototype.printIfReady=function(){if(m.assert(this.state.numImagesLoaded<=this.props.metadata.page_count,"not all images loaded"),this.state.numImagesLoaded===this.props.metadata.page_count&&this.props.onLoad)return void this.props.onLoad()},t.prototype.componentDidMount=function(){for(var e=0,t=this.props.document.getElementsByTagName("img"),a=0;a<t.length;a++)t[a].complete&&e++;this.setState({numImagesLoaded:e})},t.prototype.componentDidUpdate=function(e,t){this.printIfReady()},t.prototype.render=function(){var e=this,t={pageBreakInside:"avoid",pageBreakAfter:"always"};return n.default.createElement("div",null,n.default.createElement(d.ProgressBar,{totalImages:this.props.metadata.page_count,numImagesLoaded:this.state.numImagesLoaded}),s.mapPages(this.props.metadata.dimensions,function(a,o,r){return n.default.createElement("img",{key:a,src:i.imageUrl(e.props.imageUrlTmpl,a,0,e.props.useCanned),style:t,onLoad:e.onImageResolve(a),onError:e.onImageResolve(a),alt:""+(a+1)})}))},t})(n.default.Component);t.Printable=l,t.print=u});
//# sourceMappingURL=printable.min.js-vflbo8NoT.map